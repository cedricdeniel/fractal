<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fractal</title>
</head>
<body>
    <header>
        <button type="button" id="btn-draw-geom">Geometric</button>
        <button type="button" id="btn-draw-quad">Quadratic</button>
        <button type="button" id="btn-draw-reset">Reset</button>
    </header>
    <section>
        <canvas id="plan" width="900" height="900"><p>Désolé, votre navigateur ne supporte pas Canvas.</p></canvas>
    </section>

    <script src="js/math.js"></script>
    <script src="js/mplan.js"></script>
    <script>
        (function() {

            var options = {
                scale       : [300, 300],
                ppup        : [.13, .13], // Points per unit percent
                center      : [-0.5, 0],
                radius      : 3,
                drawAxis    : true,
            };

            mplan('#plan', options);

            var canvas  = document.querySelector('#plan');

            drawNoop();

            document.querySelector('#btn-draw-reset').addEventListener('click', function() {
                drawNoop();
            });

            document.querySelector('#btn-draw-geom').addEventListener('click', function() {
                drawGeometric();
            });

            document.querySelector('#btn-draw-quad').addEventListener('click', function() {
                drawQuadratic();
            });

            /**
             * drawNoop
             */
            function drawNoop()
            {
                canvas.getFrame()
                    .draw(function() {})
                    .draw()
                ;
            }

            /**
             * drawQuadratic
             */
            function drawQuadratic()
            {
                canvas.getFrame()
                    .draw(quadraticShape)
                    .draw()
                ;
            }

            /**
             * drawGeometric
             */
            function drawGeometric()
            {
                canvas.getFrame()
                    .draw(geometricShape)
                    .draw()
                ;
            }

            /**
             * quadraticShape
             * @param draw
             * @returns void
             */
            function quadraticShape(draw)
            {
                var mFrame = draw.getFrame();
                var minMax = mFrame.getMinMax();

                var xmin = minMax[0],
                    xmax = minMax[1],
                    ymin = minMax[2],
                    ymax = minMax[3];

                var deltaX, deltaY, i, j;

                var scale = mFrame.getOption('scale'),
                    ppup = mFrame.getOption('ppup')
                ;

                deltaX = 1 / (scale[0] * ppup[0]);
                deltaY = 1 / (scale[1] * ppup[1]);

                for (i=xmin ; i<xmax; i=i+deltaX) {

                    for (j=ymin ; j<ymax; j=j+deltaY) {

                        if (quad([i,j])) {
                            draw.point([i,j]);

                        }
                    }
                }
            }

            /**
             * geometricShape
             * @param draw
             * @returns void
             */
            function geometricShape(draw)
            {
                var mFrame = draw.getFrame();
                var minMax = mFrame.getMinMax();

                var xmin = minMax[0],
                    xmax = minMax[1],
                    ymin = minMax[2],
                    ymax = minMax[3];

                var deltaX, deltaY, i, j;

                var scale = mFrame.getOption('scale'),
                    ppup = mFrame.getOption('ppup')
                ;

                deltaX = 1 / (scale[0] * ppup[0]);
                deltaY = 1 / (scale[1] * ppup[1]);

                for (i=xmin ; i<xmax; i=i+deltaX) {

                    for (j=ymin ; j<ymax; j=j+deltaY) {

                        if (geom([i,j])) {
                            draw.point([i,j]);
                        }
                    }
                }
            }

            /**
             * quad
             * @param c
             * @returns {boolean}
             */
            function quad(c)
            {
                var z = [0,0], i;

                for (i=0; i<20; i++) {
                    z = Math.cplxAdd(Math.cplxPow(z, 2), c);

                    if (Math.modulus(z) < 10) {
                        continue;
                    } else {
                        return false;
                    }
                }

                return true;
            }

            /**
             * geom
             * @param c
             * @returns {boolean}
             */
            function geom(c)
            {
                var z = [1,0], i;

                for (i=0; i<10; i++) {
                    z = Math.cplxMult(z, c);

                    if (Math.modulus(z) < 10) {
                        continue;
                    } else {
                        return false;
                    }
                }

                return true;
            }
        })();
    </script>

</body>
</html>
